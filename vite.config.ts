import { defineConfig } from 'vitest/config';
import react from '@vitejs/plugin-react';
import player from 'play-sound';


function gladosPlugin(PORT : string) {
  return {
    name: 'glados-banner',
    configureServer() {
      console.clear();
      const asciiArt = `
    â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£·â£½â ¤â£´â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡žâ£·â£½â €â €â €â €â €â €â €â €â €â €â €â €â €
    â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¹â£†â €â €â €â €â €â €â €â €â €â €â €â €â €
    â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£»â£¿â£»â£¿â£¿â£¿â ¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£â¡‡â €â €â €â €â €â €â €â €â €â €â €â €
    â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¢§â žâ£§â¢»â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â €â €â €â €â €â €â €â €â €â €â €â €â €
    â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¢¯â£Ÿâ£¾â£»â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â£§â €â£ â£¶â£–â£¶â£¤â¡¤â£€â¡€â €â €â €â €
    â ›â¢¿â¢¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£žâ£¿â£¿â¡¿â¢â ¹â£¯â ›â ’â ¯â£•â¡¢â£„â €
    â €â ˆâ ³â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£˜â €â €â €â €â ‚â €â ‰â¢¢â¢‡
    â €â €â €â ˆâ£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£µâ¡€â €â €â €â €â €â €â ˆâ¢¿
    â €â €â €â €â ˆâ¢»â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£â¡“â¢€â¡€â¢€â¡€â €â €â €â €â¢¸
    â €â €â €â €â €â €â ™â¢Ÿâ£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡¿â£Ÿâ£Ÿâ£¿â£¿â£Ÿâ ¿â£¿â¡·â£­â£¿â£¿â£¿â£¿â£¿â¢²â¢¦â£¿â£·â£¶â£¦â¡„â €â €â¢€â¢¸
    â €â €â €â €â €â €â €â €â ˆâ ›â ¿â£»â£¿â£¿â ¿â ¿â£¿â£›â ¥â ’â ‹â â €â ˆâ ™â ¿â£¿â£¶â£­â£ºâ¢½â£¿â£¿â£¿â£¿â¢â£®â£¿â£¿â£¿â£¿â£¿â£¿â¡†â €â¡˜â¡
    â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ‰â â €â €â €â €â €â €â €â €â €â €â €â ˆâ ™â ›â ·â£¿â£¿â£¿â£¿â££â£¿â£¿â£‹â£½â£¿â£¿â£¿â  â¢°â¢¿â 
    â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢°â¢¿â£¿â£¿â£·â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£‡â §â£Ÿâ¡¿â €
    â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢€â£žâ£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£Žâ¡¿â¡¿â €â €
    â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â¢¾â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¡½â â €â €
    â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ˜â¢¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â£¿â¢Ÿâ¡žâ €â €â €â €
    â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â €â ‰â ›â ¿â¢¿â£¿â£¿â£¿â£¿â£»â Ÿâ¢‰â €â €â €â €â €
    `;
    const frames = [
      'â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%',
      'â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 10%',
      'â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 20%',
      'â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ 30%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 40%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘ 50%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 60%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ 70%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ 90%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ 90%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ 70%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 60%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘ 50%',
      'â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 40%',
      'â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ 30%',
      'â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 20%',
      'â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 10%',
      'â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%',
    ];
    let i = 0;
    console.clear();
    console.log(asciiArt);
    console.log('ðŸ’¬ GLaDOS: Initializing data stream...');
    setInterval(() => {
      process.stdout.write(`\r Funcionamiento del puerto ${frames[i]} `);
      i = (i + 1) % frames.length;
    }, 100);
    console.log(`Tu cÃ³digo funciona. Por ahora. No te acostumbres`);
    console.log(`El FrontEnd de KioscoApp esta operativo en el puerto ${PORT}`);
    
    const play = player();
      play.play('/home/lau/.config/GitKraken/scripts/glados/resources/voices/general/felicitaciones.wav', (err: any) => {
        if (err) console.error('ðŸ’¥ Error al reproducir audio:', err);
      });

    }
  };
}

// https://vite.dev/config/
export default defineConfig({
  plugins: [react(), gladosPlugin('5173')],
  test: {
    globals: true,
    environment: 'jsdom',
    // setupFiles: './setupTests.js',
  },
  server: {
    port: 5173,
    }
  })
